<#
.NAME
    Resolve-CVE-2017-8529


.SYNOPSIS
    This cmdlet is used to added the registry value required to resolve CVE-2017-8529.


.SYNTAX
    Resolve-CVE-2017-8529 [<CommonParameters>]
    

.NOTES
    Author: Rob Osborne
    Alias: tobor
    Contact: rosborne@osbornepro.com


.INPUTS
    None
        You cannot pipe input to this cmdlet.


.OUTPUTS
    System.Management.Automation.PSCustomObject
        New-ItemProperty returns a custom object that contains the new property.


.LINK
    https://github.com/tobor88
    https://www.powershellgallery.com/profiles/tobor
    https://roberthosborne.com

#>
    [CmdletBinding()]
        param()

Write-Verbose "[*] Checking OS Architecture value"

Try
{

    $OS = (Get-CimInstance -ClassName 'CIM_OperatingSystem').OSArchitecture

}  # End Try
Catch
{

    $OS = (Get-WmiObject -ClassName'CIM_OperatingSystem').OSArchitecture

}  # End Catch

If (!($OS))
{

    Try
    {

        $OS = (wmic os get OSArchitecture)[2]

    }  # End Try
    Catch
    {

        $IsIt = [System.Environment]::Is64BitOperatingSystem

        If ($IsIt)
        {

            $OS = "64-bit"

        }  # End If
        Else
        {

            $OS = "32-bit"

        }  # End Else

    }  # End Catch

}  # End If

If ($OS -eq '64-bit')
{

    Write-Verbose "[*] 64-bit ARCHITECTURE: Setting FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX iexplrer.exe registry value to 1."

    New-Item -Path 'HKLM:\SOFTWARE\WOW6432Node\Microsoft\Internet Explorer\Main\FeatureControl' -Name 'FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX'

    New-ItemProperty -Path 'HKLM:\SOFTWARE\WOW6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX' -Name iexplorer.exe -Value 1 -PropertyType DWORD


}  # End If
ElseIf ($OS -eq '32-bit')
{

    Write-Verbose "[*] 32-Bit ARCHITECTURE: Setting FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX iexplrer.exe registry value to 1."

    New-Item -Path 'HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl' -Name 'FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX'

    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX' -Name iexplorer.exe -Value 1 -PropertyType DWORD


}  # End ElseIf
Else
{

    Write-Output "[!] Both 32-bit and 64-bit architecture registry settings will be added as the OS architecture could not be determined"

    # x64
    New-Item -Path 'HKLM:\SOFTWARE\WOW6432Node\Microsoft\Internet Explorer\Main\FeatureControl' -Name 'FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX'
    New-ItemProperty -Path 'HKLM:\SOFTWARE\WOW6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX' -Name iexplorer.exe -Value 1 -PropertyType DWORD

    # x86
    New-Item -Path 'HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl' -Name 'FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX'
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_ENABLE_PRINT_INFO_DISCLOSURE_FIX' -Name iexplorer.exe -Value 1 -PropertyType DWORD

}  # End Else
