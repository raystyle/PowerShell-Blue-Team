<#
.NAME
    Resolve-CVE-2020-1350


.SYNOPSIS
    This cmdlet is used to add the registry value that can be used as a workaround for CVE-2020-1350.


.SYNTAX
    Resolve-CVE-2020-1350 [<CommonParameters>]


.DESCRIPTION
    This cmdlet create the registry value HKLM:\SYSTEM\CurrentControlSet\Services\DNS\Parameters TcpReceivePacketSize
    and sets it to the max allowable size 0xFF00. This can be used to mitigate CVE-2020-1350 without Windows Update
    KB4569509 which requires a reboot of the server. Changing this registry value does not require a reboot.


.EXAMPLE
    -------------------------- EXAMPLE 1 --------------------------
    C:\PS> Resolve-CVE-2020-1350


.NOTES
    Author: Rob Osborne
    Alias: tobor
    Contact: rosborne@osbornepro.com


.INPUTS
    None
        You cannot pipe input to this cmdlet.


.OUTPUTS
    System.Management.Automation.PSCustomObject
        New-ItemProperty returns a custom object that contains the new property.


.LINK
    https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability
    https://nvd.nist.gov/vuln/detail/CVE-2020-1350
    https://github.com/tobor88
    https://gitlab.com/tobor88
    https://www.powershellgallery.com/profiles/tobor
    https://roberthosborne.com
    https://osbornepro.com

#>
Function Resolve-CVE-2017-8529 {
    [CmdletBinding()]
        param()

    $Path = 'HKLM:\SYSTEM\CurrentControlSet\Services\DNS\Parameters'
    $Name = 'TcpReceivePacketSize'
    $Value = '0xFF00'

    If (Test-Path -Path "$Path")
    {

        Write-Output "[*] Registry path location exists: $Path"

    }  # If
    Else
    {

        Write-Verbose "Creating registry key value: $Key"
        New-Item -Path "$Path" -Force

    }  # End Else

    If (65280 -ne (Get-ItemProperty -Path "$Path" -Name "$Name").$Name)
    {

        Write-Verbose "[*] Setting registry DWORD value"

        New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType DWORD

    }  # End If
    Else
    {

        Write-Output "[*] Registry Value is already set correctly"

    } # End Else

}  # End Function Resolve-CVE-2020-1350
